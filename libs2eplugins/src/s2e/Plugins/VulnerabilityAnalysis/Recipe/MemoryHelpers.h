///
/// Copyright (C) 2016, Dependable Systems Laboratory, EPFL
/// Copyright (C) 2016, Cyberhaven
/// All rights reserved.
///
/// Licensed under the Cyberhaven Research License Agreement.
///

#ifndef S2E_PLUGINS_RecipeMemHelpers_H_
#define S2E_PLUGINS_RecipeMemHelpers_H_

#include <unordered_set>
#include "Recipe.h"

namespace s2e {
namespace plugins {
namespace recipe {

void FindMemoryPages(const DecreeMonitor::MemoryMap &map, bool mustBeWritable, bool mustBeExecutable,
                     std::unordered_set<uint64_t> &pages);

void FindSequencesOfSymbolicData(const klee::BitArray *concreteMask, uint64_t baseAddr, AddrSize *prevItem,
                                 std::vector<AddrSize> &sequences);

void FindSequencesOfSymbolicData(S2EExecutionState *state, const DecreeMonitor::MemoryMap &map, bool mustBeExecutable,
                                 std::vector<AddrSize> &symbolicSequences);
}
}
}

#endif
